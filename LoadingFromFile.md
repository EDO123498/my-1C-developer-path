
### Описание
----
#### `☑ перейти к определенному формату`
|[.txt и .csv](#txt-and-csv)|[.xlsx](#xlsx)|[.dbf](#dbf)|[.xml](#xml)|[.json](#json)|
|-|-|-|-|-|
----
- [x] описание 1

картинка окна

- [x] описание 2
```js
&НаКлиенте
Процедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, ВыборДобавлением, СтандартнаяОбработка)
	
	Проводник = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	Проводник.Заголовок = "Проводник";
	Проводник.Каталог = "P:\Table\обучение программированию";
	
	Если Объект.Формат = "TXT" Тогда 
	  	Фильтр = "Текстовый документ (*.txt)|*.txt";
		
	ИначеЕсли Объект.Формат = "CSV" Тогда 
	  	Фильтр = "Текстовый документ (*.csv)|*.csv"; 
		
	ИначеЕсли Объект.Формат = "XLSX" Тогда 
	  	Фильтр = "Файл Excel (*.xlsx)|*.xlsx";
		
	ИначеЕсли Объект.Формат = "DBF" Тогда 
	  	Фильтр = "Таблица DBF (*.dbf)|*.dbf";
		
	ИначеЕсли Объект.Формат = "XML" Тогда 
	  	Фильтр = "XML-файл (*.xml)|*.xml";
		
	ИначеЕсли Объект.Формат = "JSON" Тогда 
	  	Фильтр = "JSON-файл (*.json)|*.json";	
		
	Иначе 
		Возврат;
		
	КонецЕсли;
		
	Проводник.Фильтр = Фильтр;
	
	Оповещение = Новый ОписаниеОповещения("ПослеВыбораФайла", ЭтотОбъект);
	
	Проводник.Показать(Оповещение);
	
КонецПроцедуры
```

`содержание процедуры «ПослеВыбораФайла»`

```js
Процедура ПослеВыбораФайла (ВыбранныеФайлы, ДополнительныеПараметры) Экспорт
		
	Если ВыбранныеФайлы = Неопределено Тогда 
		Возврат;	
	КонецЕсли;
	
	Объект.ПутьКФайлу = ВыбранныеФайлы [0];

КонецПроцедуры
```

[1]: - [x] описание команды прочитать
```js
&НаКлиенте
 Процедура Прочитать(Команда)
	
	Объект.СоставДокумента.Очистить();
	
	Если Объект.Формат = "TXT" ИЛИ Объект.Формат = "CSV" Тогда 
		
		ПрочитатьФайлTXTилиCSV();
		
	ИначеЕсли Объект.Формат = "XLSX" Тогда 
		
		ПрочитатьФайлXLSX();
		
	ИначеЕсли Объект.Формат = "DBF" Тогда 
		
		ПрочитатьФайлDBF();
		
	ИначеЕсли Объект.Формат = "XML" Тогда 
		
		ПрочитатьФайлXML();	
		
	ИначеЕсли Объект.Формат = "JSON" Тогда 
		
		ПрочитатьФайлJSON();
		
	КонецЕсли;
		
КонецПроцедуры
```
----
### `txt` and `csv`
----
>#### `☑ последовательное чтение`
```js
&НаКлиенте
Процедура ПрочитатьФайлTXTилиCSV()

	ПоследовательноеЧтение = Истина;
	
	Если ПоследовательноеЧтение Тогда  
		
		Текст = Новый ЧтениеТекста(Объект.ПутьКФайлу, КодировкаТекста.UTF8);
				
		ТекущаяСтрока = Текст.ПрочитатьСтроку();
		
		Пока ТекущаяСтрока <> Неопределено Цикл
			
			МассивСлов = СтрРазделить(ТекущаяСтрока, ";");
			
			Если МассивСлов.Количество() < 3 Тогда 
				
				Продолжить;
				
			КонецЕсли;
			
			НоваяСтрока = Объект.СоставДокумента.Добавить();
			НоваяСтрока.Наименование 	= МассивСлов[0];
			НоваяСтрока.Статус 		= МассивСлов[1];
			НоваяСтрока.ИНН 		= МассивСлов[2];	
			
			ТекущаяСтрока = Текст.ПрочитатьСтроку();
			
		КонецЦикла;
	
	КонецЕсли;

КонецПроцедуры 
```
>#### `☑ чтение текстового документа`
```js
&НаКлиенте
Процедура ПрочитатьФайлTXTилиCSV()

Текст = Новый ТекстовыйДокумент;
	Текст.Прочитать(Объект.ПутьКФайлу, КодировкаТекста.UTF8);
				
	Для НомерСтроки = 1 По Текст.КоличествоСтрок() Цикл 
			
		ТекущаяСтрока = Текст.ПолучитьСтроку(НомерСтроки);
			
		МассивСлов = СтрРазделить(ТекущаяСтрока, ";");
			
		Если МассивСлов.Количество() < 3 Тогда 
				
			Продолжить;
				
		КонецЕсли;
			
		НоваяСтрока = Объект.СоставДокумента.Добавить();
		НоваяСтрока.Наименование 	= МассивСлов[0];
		НоваяСтрока.Статус 		= МассивСлов[1];
		НоваяСтрока.ИНН 		= МассивСлов[2];
			
	КонецЦикла;
		
КонецПроцедуры
```
----
### `xlsx`
----
>#### `☑ передача файла на сервер`
```js
&НаКлиенте
Процедура ПрочитатьФайлXLSX()

	ДвоичныеДанныеФайла 	= Новый ДвоичныеДанные(Объект.ПутьКФайлу);
	АдресДанных 		= ПоместитьВоВременноеХранилище(ДвоичныеДанныеФайла);
	ПрочитатьФайлНаСервереXLSX(АдресДанных);	

КонецПроцедуры 
```
>#### `☑ чтение файла на сервере`
```js
&НаСервере
Процедура ПрочитатьФайлНаСервереXLSX(АдресДанных)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	
	Данные = ПолучитьИзВременногоХранилища(АдресДанных);
	ПутьКФайлуНаСервере = ПолучитьИмяВременногоФайла("xlsx");
	Данные.Записать(ПутьКФайлуНаСервере);
	
	Попытка
		
		ТабличныйДокумент.Прочитать(ПутьКФайлуНаСервере, 
						СпособЧтенияЗначенийТабличногоДокумента.Значение);		
		
	Исключение
		
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = "Не удалось прочитать указанный файл по причине: " + ОписаниеОшибки();
		Сообщение.Сообщить();
		Возврат;
		
	КонецПопытки;
	
	КоличествоСтрок = ТабличныйДокумент.ВысотаТаблицы;
	
	Для СтрокаТаблицы = 2 по КоличествоСтрок Цикл
		
		НоваяСтрока = Объект.СоставДокумента.Добавить();
		НоваяСтрока.Наименование = ТабличныйДокумент.ПолучитьОбласть
					("R" + Формат(СтрокаТаблицы, "ЧГ=0") + "C" + 1).ТекущаяОбласть.Текст;
		НоваяСтрока.Статус 	 = ТабличныйДокумент.ПолучитьОбласть
					("R" + Формат(СтрокаТаблицы, "ЧГ=0") + "C" + 2).ТекущаяОбласть.Текст;
		НоваяСтрока.ИНН 	 = ТабличныйДокумент.ПолучитьОбласть
					("R" + Формат(СтрокаТаблицы, "ЧГ=0") + "C" + 3).ТекущаяОбласть.Текст;
				
	КонецЦикла;
		
КонецПроцедуры
```
----
### `dbf`
----
>#### `☑ необходимо сначала скопировать файл, чтобы имя документа было < 8 символов`
```js
&НаКлиенте
Процедура ПрочитатьФайлDBF ()
	
	НовыйПутьКФайлу = КаталогВременныхФайлов() + "newname.dbf";
	
	КопироватьФайл(Объект.ПутьКФайлу, НовыйПутьКФайлу); 
	
	ФайлDBF = Новый XBase;
			
	ФайлDBF.ОткрытьФайл(НовыйПутьКФайлу);
	
	Если ФайлDBF.Первая() = Ложь Тогда 
		Возврат;
	КонецЕсли;
	
	Пока ФайлDBF.ВКонце() = Ложь Цикл
		
		НоваяСтрока = Объект.СоставДокумента.Добавить();
		НоваяСтрока.Наименование = ФайлDBF.Name;
		НоваяСтрока.Статус 	 = ФайлDBF.Status;
		НоваяСтрока.ИНН 	 = ФайлDBF.INN;
		ФайлDBF.Следующая();
	    	
	КонецЦикла;
	
	ФайлDBF.ЗакрытьФайл();
		
КонецПроцедуры
``` 
### [``menu``](#Описание)

